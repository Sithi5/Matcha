{% extends './edit_user/layout.html.twig' %}

{% block title %}
  Edit profile picture
{% endblock %}

{% block stylesheets %}
  {{ parent() }}
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/dropzone/5.5.1/min/dropzone.min.css" integrity="sha256-e47xOkXs1JXFbjjpoRr1/LhVcqSzRmGmPqsrUQeVs+g=" crossorigin="anonymous" />
{% endblock stylesheets %}

{% block body %}
	{{ parent() }}

  <div class="container register-form">
    {# content #}
    <div class="text-center" style="color: #757575;">
      <div class="card-register">
        <h5 class="card-header info-color white-text text-center py-4">
          <strong>Change your profil picture</strong>
        </h5>
        <div class="card-body px-lg-5 pt-0">
          <form enctype="multipart/form-data" class="dropzone" action="{{ app.request.uri }}" method="post" name="acme_dropzone_form" id="dropzoneForm">
              {{ form_widget(form) }}
              <div id="preview"></div>
              {{ form_end(form) }}
              <input type="button" id="button-upload-files" class="btn btn-primary" value='Upload files'>
        </div>
      </div>
    </div>
  </div>

{% endblock %}

{% block javascripts %}
  {{ parent() }}
  <script src="https://cdnjs.cloudflare.com/ajax/libs/dropzone/5.5.1/min/dropzone.min.js" integrity="sha256-cs4thShDfjkqFGk5s2Lxj35sgSRr4MRcyccmi0WKqCM=" crossorigin="anonymous"></script>
  <script>
    Dropzone.autoDiscover = false;

    var myDropzone = new Dropzone(".dropzone", {
      autoProcessQueue: false,
      parallelUploads: 1, // Number of files process at a time (default 2)
      maxFilesize: 10, // MB
      maxFiles: 1,
      acceptedFiles: "image/*",
      addRemoveLinks: true,
    });

    $('#button-upload-files').click(function(){
      myDropzone.processQueue();
      location.reload();
    });

  </script>
{% endblock javascripts %}